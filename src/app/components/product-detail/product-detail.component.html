<div class="container mt-4">
  <div *ngIf="loading" class="text-center">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2">Loading product details...</p>
  </div>

  <div *ngIf="error" class="alert alert-danger">
    <i class="fas fa-exclamation-circle me-2"></i>
    {{ error }}
  </div>

  <div *ngIf="product && !loading">
    <div class="card shadow-sm product-card">
      <div class="card-body d-flex">
        <!-- Product Image (Zoomable) -->
        <div class="product-image-container me-3">
          <img 
            [src]="product.productImageURL" 
            alt="Product Image" 
            class="product-image"
          />
        </div>

        <!-- Product Details -->
        <div class="product-details">
          <!-- Product Name -->
          <div class="mb-3 text-center">
            <h2 class="product-name text-pink">
              {{ product.nameProduct }}
            </h2>
          </div>

          <!-- Size -->
          <div class="product-attribute mb-3">
            <span class="label">Size:</span>
            <span class="value">{{ product.productSize }}</span>
          </div>

          <!-- Description -->
          <div class="product-attribute mb-3">
            <span class="label">Description:</span>
            <span class="value">{{ product.productDescription }}</span>
          </div>

          <!-- Date Added -->
          <div class="product-attribute mb-3">
            <span class="label">Date Added:</span>
            <span class="value">{{ product.dateProductAdded | date:'shortDate' }}</span>
          </div>

          <!-- Gender -->
          <div class="product-attribute mb-3">
            <span class="label">Gender:</span>
            <span class="value">{{ product.genderProduct}}</span>
          </div>

          <!-- Reserved Status -->
          <div class="product-attribute mb-3">
            <span class="label">Status:</span>
            <span class="value" [ngClass]="{'text-success': product.reserved, 'text-danger': !product.reserved}">
              {{ product.reserved ? 'Reserved' : 'Not Reserved' }}
            </span>
          </div>

          <!-- Product Price -->
          <div class="product-attribute mb-3">
            <span class="label">Price:</span>
            <span class="value fs-4 text-success">{{ product.productPrice}}</span>
          </div>
        </div>
      </div>
      <h6  class="product-location-header">Find the product's pickup location:</h6>
      <div id="map" style="height: 400px; width: 100%; margin-top: 20px;"></div>
      <div class="card-footer bg-transparent border-top py-2">
         <div class="d-flex flex-column align-items-center gap-2 mt-2">
        <!-- First row - Edit/Delete -->
        <div *ngIf="isCurrentUsersProduct"  class="d-flex justify-content-between align-items-center mb-4 px-3">
          <a [routerLink]="['/products/edit', product.productId]" class="btn btn-green-rect">Edit</a>
          <button (click)="deleteProduct(product.productId)" class="btn btn-red-rect">Delete</button>
        </div>
        <div class="d-flex justify-content-between align-items-center mb-4 px-3">
        <button (click)="goBack()" class="btn btn-pink2-rect ">Back</button>
        </div>
      </div>     
      </div>
    </div>

    <!-- Recommended Products Section -->
    <div *ngIf="recommendedProducts.length > 0" class="mt-4">
      <h3 class="text-center mb-4">Recommended for you</h3>
      <div class="row">
        <div *ngFor="let recommended of recommendedProducts" class="col-md-4 col-sm-6 mb-4">
          <div class="card recommended-card h-100" [routerLink]="['/products/view', recommended.productId]" style="cursor: pointer;">
            <img [src]="recommended.productImageURL" class="card-img-top recommended-image" alt="{{recommended.nameProduct}}">
            <div class="card-body">
              <h5 class="card-title">{{recommended.nameProduct}}</h5>
              <div class="d-flex justify-content-between">
                <span class="text-muted">{{recommended.productSize}}</span>
                <span class="fw-bold">{{recommended.productPrice}} DT</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>